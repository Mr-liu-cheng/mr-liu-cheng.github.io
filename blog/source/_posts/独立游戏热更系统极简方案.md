---
title: ç‹¬ç«‹æ¸¸æˆçƒ­æ›´ç³»ç»Ÿæç®€æ–¹æ¡ˆ
date: 2026-01-30 10:28:46
updated: 2026-01-30 10:28:46
tags: æ¸¸æˆçƒ­æ›´
categories: æ¸¸æˆçƒ­æ›´
keywords: æ¸¸æˆçƒ­æ›´
description:
---


# ç‹¬ç«‹æ¸¸æˆçƒ­æ›´ç³»ç»Ÿæç®€æ–¹æ¡ˆ

## ä¸€ã€æœ€ç²¾ç®€é…ç½®ï¼ˆæœ€ä½æˆæœ¬å¯åŠ¨ï¼‰

### ğŸ¯ **åªéœ€3ä»¶äº‹å°±èƒ½å¼€å§‹ï¼š**

1. **ä¸€ä¸ªäº‘å­˜å‚¨è´¦å·** - å­˜æ”¾æ¸¸æˆèµ„æº
2. **ä¸€ä¸ªç®€å•çš„ç‰ˆæœ¬ç®¡ç†æœåŠ¡** - å‘Šè¯‰ç©å®¶æ›´æ–°ä»€ä¹ˆ
3. **æ¸¸æˆå†…çš„æ›´æ–°å™¨** - ä¸‹è½½å¹¶åº”ç”¨æ›´æ–°

---

## äºŒã€å…·ä½“è¦åšçš„4ä¸ªæ ¸å¿ƒç»„ä»¶

### 1. **èµ„æºå­˜å‚¨ï¼ˆæœ€ç®€å•ï¼‰**
```yaml
æ¨èæ–¹æ¡ˆ: é˜¿é‡Œäº‘OSSå…è´¹é¢åº¦
- æ³¨å†Œé˜¿é‡Œäº‘è´¦å·ï¼ˆä¸ªäººå³å¯ï¼‰
- åˆ›å»ºBucket: your-game-resources
- è®¾ç½®æƒé™: å…¬å…±è¯»ï¼ˆèŠ‚çœé‰´æƒå¼€å‘ï¼‰
- å…è´¹é¢åº¦: 40GBå­˜å‚¨/æœˆï¼Œè¶³å¤Ÿå°æ¸¸æˆç”¨

ä¸Šä¼ å·¥å…·: ç”¨å®˜æ–¹OSS Browserå®¢æˆ·ç«¯
- å›¾å½¢ç•Œé¢ï¼Œæ‹–æ‹½ä¸Šä¼ 
- ä¸ç”¨å†™ä»£ç ç®¡ç†æ–‡ä»¶
```

### 2. **ç‰ˆæœ¬ç®¡ç†æœåŠ¡ï¼ˆæœ€ç®€åŒ–ï¼‰**
```python
# æœ€ç®€å•çš„æ–¹å¼ï¼šé™æ€JSONæ–‡ä»¶
# 1. åˆ›å»º version.json æ”¾åˆ°OSS
{
  "latest_version": "1.0.1",
  "min_version": "1.0.0",  # æ”¯æŒçš„æœ€ä½ç‰ˆæœ¬
  "update_url": "https://your-game.oss-cn-hangzhou.aliyuncs.com/",
  "files": [
    {
      "name": "ui.ab",
      "size": 1024000,
      "md5": "abc123...",
      "url": "https://your-game.oss-cn-hangzhou.aliyuncs.com/v1.0.1/ui.ab"
    }
  ]
}

# 2. Unityä¸­è¯»å–è¿™ä¸ªJSONæ£€æŸ¥æ›´æ–°
# ä»£ç ä¸è¶…è¿‡100è¡Œ
```

### 3. **Unityæ›´æ–°å™¨ï¼ˆæ ¸å¿ƒï¼‰**
```csharp
// GameUpdater.cs - æœ€ç®€å®ç°
public class GameUpdater : MonoBehaviour
{
    public IEnumerator CheckAndUpdate()
    {
        // 1. ä¸‹è½½ç‰ˆæœ¬ä¿¡æ¯
        string versionUrl = "https://your-game.oss-cn-hangzhou.aliyuncs.com/version.json";
        UnityWebRequest request = UnityWebRequest.Get(versionUrl);
        yield return request.SendWebRequest();
        
        // 2. è§£æJSON
        VersionInfo info = JsonUtility.FromJson<VersionInfo>(request.downloadHandler.text);
        
        // 3. æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°
        if (info.latest_version != PlayerPrefs.GetString("CurrentVersion"))
        {
            // 4. ä¸‹è½½æ–°æ–‡ä»¶
            foreach (var file in info.files)
            {
                yield return DownloadFile(file.url, file.md5);
            }
            
            // 5. æ›´æ–°å®Œæˆ
            PlayerPrefs.SetString("CurrentVersion", info.latest_version);
        }
    }
    
    IEnumerator DownloadFile(string url, string expectedMd5)
    {
        UnityWebRequest request = UnityWebRequest.Get(url);
        yield return request.SendWebRequest();
        
        // ä¿å­˜åˆ°æœ¬åœ°
        string localPath = Path.Combine(Application.persistentDataPath, Path.GetFileName(url));
        File.WriteAllBytes(localPath, request.downloadHandler.data);
        
        // ç®€å•æ ¡éªŒï¼ˆå¯é€‰ï¼‰
        string actualMd5 = CalculateMD5(localPath);
        if (actualMd5 != expectedMd5)
        {
            Debug.LogError("æ–‡ä»¶æ ¡éªŒå¤±è´¥ï¼Œé‡æ–°ä¸‹è½½");
        }
    }
}
```

### 4. **å‘å¸ƒå·¥å…·ï¼ˆæ‰‹åŠ¨ä½†å¤Ÿç”¨ï¼‰**
```bash
# å‘å¸ƒè„šæœ¬ publish.shï¼ˆWindowsç”¨.batï¼‰
#!/bin/bash

# 1. æ„å»ºABåŒ…
/Applications/Unity/Hub/Editor/2021.3.21f1/Unity.app/Contents/MacOS/Unity \
  -batchmode \
  -nographics \
  -projectPath $(pwd) \
  -executeMethod BuildScript.BuildAssetBundles \
  -quit

# 2. ç”Ÿæˆversion.json
python generate_version.py

# 3. ä¸Šä¼ åˆ°OSS
ossutil cp -r ./Output/ oss://your-game-resources/ --update
```

---

## ä¸‰ã€ä½ éœ€è¦åšçš„å…·ä½“æ­¥éª¤

### ğŸ“‹ **Day 1-2ï¼šæ­å»ºåŸºç¡€**
```bash
1. æ³¨å†Œé˜¿é‡Œäº‘è´¦å·ï¼ˆå…è´¹ï¼‰
2. å¼€é€šOSSæœåŠ¡ï¼Œåˆ›å»ºBucket
3. ä¸‹è½½OSS Browserå®¢æˆ·ç«¯
4. åœ¨Unityä¸­åˆ›å»ºGameUpdaterè„šæœ¬
```

### ğŸ“‹ **Day 3-5ï¼šå®ç°æ ¸å¿ƒåŠŸèƒ½**
```csharp
// åªéœ€å®ç°3ä¸ªæ ¸å¿ƒå‡½æ•°ï¼š
1. CheckUpdate() - æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ–°
2. DownloadFiles() - ä¸‹è½½æ–°èµ„æº
3. ApplyUpdate() - åº”ç”¨æ›´æ–°

// è¾…åŠ©åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰ï¼š
- è¿›åº¦æ¡æ˜¾ç¤º
- æ–­ç‚¹ç»­ä¼ ï¼ˆç”¨UnityWebRequestè‡ªå¸¦ï¼‰
- é”™è¯¯é‡è¯•
```

### ğŸ“‹ **Day 6-7ï¼šæµ‹è¯•å’Œå‘å¸ƒ**
```bash
1. æœ¬åœ°æµ‹è¯•æ›´æ–°æµç¨‹
2. ä¸Šä¼ ç¬¬ä¸€ä¸ªç‰ˆæœ¬åˆ°OSS
3. ç©å®¶ç«¯æµ‹è¯•ä¸‹è½½
4. ä¿®å¤å‘ç°çš„é—®é¢˜
```

---

## å››ã€æˆæœ¬ä¼°ç®—ï¼ˆæœ€å°åŒ–ï¼‰

### ğŸ’° **æ¯æœˆè´¹ç”¨ï¼šæ¥è¿‘0å…ƒ**
```yaml
é˜¿é‡Œäº‘å…è´¹é¢åº¦:
- å­˜å‚¨: 40GBï¼ˆå°æ¸¸æˆå®Œå…¨å¤Ÿç”¨ï¼‰
- CDNæµé‡: 20GBï¼ˆå‡è®¾100ä¸ªç©å®¶ï¼Œæ¯äººæ›´æ–°200MBï¼‰
- è¯·æ±‚æ¬¡æ•°: 100ä¸‡æ¬¡ï¼ˆæ ¹æœ¬ç”¨ä¸å®Œï¼‰

å®é™…å¯èƒ½è´¹ç”¨:
- è¶…å‡ºéƒ¨åˆ†: 0.12å…ƒ/GBå­˜å‚¨ï¼Œ0.24å…ƒ/GBæµé‡
- é¢„ä¼°æœˆè´¹: < 10å…ƒï¼ˆå°æ¸¸æˆï¼‰
```

---

## äº”ã€è¿›é˜¶åŠŸèƒ½ï¼ˆæŒ‰éœ€æ·»åŠ ï¼‰

### ğŸ”§ **å½“ä½ éœ€è¦æ—¶å†æ·»åŠ ï¼š**

```yaml
# ç©å®¶å¤šäº†ä¹‹åæ·»åŠ ï¼š
1. å·®åˆ†æ›´æ–°ï¼ˆèŠ‚çœæµé‡ï¼‰
   - ä½¿ç”¨bsdiffå¼€æºåº“
   - åªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†

2. CDNåŠ é€Ÿï¼ˆä¸‹è½½æ…¢æ—¶ï¼‰
   - é˜¿é‡Œäº‘CDNå…è´¹20GB
   - é…ç½®CNAMEæŒ‡å‘OSS

3. ç‰ˆæœ¬ç®¡ç†åå°ï¼ˆæ‰‹åŠ¨éº»çƒ¦æ—¶ï¼‰
   - ç”¨Python Flaskå†™ä¸ªç®€å•ç½‘é¡µ
   - æ‹–æ‹½ä¸Šä¼ ï¼Œä¸€é”®å‘å¸ƒ

4. æ•°æ®åˆ†æï¼ˆæƒ³çŸ¥é“è°åœ¨æ›´æ–°ï¼‰
   - Google Analyticså…è´¹ç‰ˆ
   - è®°å½•æ›´æ–°æˆåŠŸ/å¤±è´¥
```

---

## å…­ã€å¿…é¡»é¿å¼€çš„å‘

### âŒ **ä¸è¦åšçš„ï¼š**
1. **ä¸è¦**ä¸€å¼€å§‹å°±åšå¤æ‚çš„å·®åˆ†æ›´æ–°
2. **ä¸è¦**è‡ªå·±åšCDNï¼Œç”¨äº‘æœåŠ¡å•†çš„
3. **ä¸è¦**å†™å¤æ‚çš„åå°ç®¡ç†ç³»ç»Ÿ
4. **ä¸è¦**è¿‡åº¦è®¾è®¡æ¶æ„

### âœ… **ä¸€å®šè¦åšçš„ï¼š**
1. **ä¸€å®šè¦**æµ‹è¯•ç½‘ç»œä¸å¥½æ—¶çš„æ›´æ–°
2. **ä¸€å®šè¦**æ ¡éªŒæ–‡ä»¶å®Œæ•´æ€§ï¼ˆMD5ï¼‰
3. **ä¸€å®šè¦**æœ‰ç‰ˆæœ¬å›æ»šæ–¹æ¡ˆ
4. **ä¸€å®šè¦**è®°å½•æ›´æ–°æ—¥å¿—ï¼ˆç®€å•txtæ–‡ä»¶ï¼‰

---

## ä¸ƒã€å®Œæ•´ä»£ç ç¤ºä¾‹ï¼ˆæœ€å°å¯è¡Œï¼‰

```csharp
// MinimalUpdater.cs - ç‹¬ç«‹æ¸¸æˆå¤Ÿç”¨äº†
using System.Collections;
using UnityEngine;
using UnityEngine.Networking;
using System.IO;
using System.Security.Cryptography;
using System.Text;

public class MinimalUpdater : MonoBehaviour
{
    public string versionUrl = "https://your-game.oss-cn-hangzhou.aliyuncs.com/version.json";
    
    void Start()
    {
        StartCoroutine(SimpleUpdate());
    }
    
    IEnumerator SimpleUpdate()
    {
        // 1. è·å–ç‰ˆæœ¬ä¿¡æ¯
        UnityWebRequest versionReq = UnityWebRequest.Get(versionUrl);
        yield return versionReq.SendWebRequest();
        
        if (versionReq.result != UnityWebRequest.Result.Success)
        {
            Debug.Log("æ£€æŸ¥æ›´æ–°å¤±è´¥ï¼Œç»§ç»­æ¸¸æˆ");
            yield break;
        }
        
        VersionData data = JsonUtility.FromJson<VersionData>(versionReq.downloadHandler.text);
        
        // 2. æ¯”è¾ƒç‰ˆæœ¬
        string currentVer = PlayerPrefs.GetString("GameVersion", "1.0.0");
        if (data.latest_version == currentVer)
        {
            Debug.Log("å·²æ˜¯æœ€æ–°ç‰ˆæœ¬");
            yield break;
        }
        
        // 3. æ˜¾ç¤ºæ›´æ–°æç¤º
        Debug.Log($"å‘ç°æ–°ç‰ˆæœ¬ {data.latest_version}ï¼Œå¼€å§‹ä¸‹è½½");
        
        // 4. ä¸‹è½½æ–‡ä»¶
        foreach (FileInfo file in data.files)
        {
            yield return DownloadAndSave(file);
        }
        
        // 5. æ›´æ–°å®Œæˆ
        PlayerPrefs.SetString("GameVersion", data.latest_version);
        Debug.Log("æ›´æ–°å®Œæˆï¼Œé‡å¯æ¸¸æˆç”Ÿæ•ˆ");
    }
    
    IEnumerator DownloadAndSave(FileInfo file)
    {
        string localPath = Path.Combine(Application.persistentDataPath, file.name);
        
        UnityWebRequest request = UnityWebRequest.Get(file.url);
        yield return request.SendWebRequest();
        
        if (request.result == UnityWebRequest.Result.Success)
        {
            File.WriteAllBytes(localPath, request.downloadHandler.data);
            
            // ç®€å•æ ¡éªŒ
            if (CalculateMD5(localPath) == file.md5)
            {
                Debug.Log($"ä¸‹è½½æˆåŠŸ: {file.name}");
            }
        }
    }
    
    string CalculateMD5(string filePath)
    {
        using (var md5 = MD5.Create())
        {
            using (var stream = File.OpenRead(filePath))
            {
                var hash = md5.ComputeHash(stream);
                return BitConverter.ToString(hash).Replace("-", "").ToLowerInvariant();
            }
        }
    }
}

[System.Serializable]
public class VersionData
{
    public string latest_version;
    public FileInfo[] files;
}

[System.Serializable]
public class FileInfo
{
    public string name;
    public string url;
    public string md5;
}
```

---

## æ€»ç»“ï¼šç‹¬ç«‹æ¸¸æˆå¼€å‘è€…è¦åšçš„

### ğŸ› ï¸ **å®é™…ä½ éœ€è¦ï¼š**

1. **1ä¸ªäº‘å­˜å‚¨**ï¼ˆé˜¿é‡Œäº‘OSSï¼‰
2. **1ä¸ªC#è„šæœ¬**ï¼ˆä¸Šé¢çš„MinimalUpdaterï¼‰
3. **1ä¸ªJSONæ–‡ä»¶**ï¼ˆversion.jsonï¼‰
4. **1ä¸ªä¸Šä¼ å·¥å…·**ï¼ˆOSS Browserå®¢æˆ·ç«¯ï¼‰

### ğŸ“… **æ—¶é—´å®‰æ’ï¼š**

- **å‘¨æœ«2å¤©**ï¼šæ­å»ºåŸºç¡€ï¼Œè·‘é€šæµç¨‹
- **ä¸‹å‘¨ç©ºé—²æ—¶é—´**ï¼šä¼˜åŒ–ä½“éªŒï¼Œæ·»åŠ è¿›åº¦æ¡
- **ä»¥åç»´æŠ¤**ï¼šæŒ‰éœ€æ·»åŠ åŠŸèƒ½

### ğŸ’¡ **æ ¸å¿ƒç†å¿µï¼š**

**å…ˆè·‘èµ·æ¥ï¼Œå†ä¼˜åŒ–ã€‚**  
ä½ çš„æ ¸å¿ƒæ˜¯æ¸¸æˆå†…å®¹ï¼Œçƒ­æ›´ç³»ç»Ÿåªæ˜¯è®©ç©å®¶èƒ½ç©åˆ°æ–°å†…å®¹çš„å·¥å…·ã€‚å¤Ÿç”¨å°±è¡Œï¼Œä¸è¦è¿‡åº¦å·¥ç¨‹åŒ–ã€‚

**ç°åœ¨å°±å¯ä»¥å¼€å§‹ï¼š**
1. æ‰“å¼€é˜¿é‡Œäº‘å®˜ç½‘æ³¨å†Œ
2. åœ¨Unityé‡Œæ–°å»ºC#è„šæœ¬
3. ä»Šæ™šå°±èƒ½çœ‹åˆ°æ•ˆæœ

æœ‰é—®é¢˜éšæ—¶å†é—®ï¼Œæˆ‘å¯ä»¥å¸®ä½ å†™å…·ä½“ä»£ç ï¼
