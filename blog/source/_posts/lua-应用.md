---
title: lua åº”ç”¨
date: 2025-02-19 11:20:13
updated: 2025-02-19 11:20:13
tags:
categories:
keywords:
description:
---
æ–‡æ¡£ï¼š
- [Luatos](https://wiki.luatos.com/index.html)
- [å‚è€ƒæ‰‹å†Œ](https://wiki.luatos.com/_static/lua53doc/contents.html)

åœ¨ Unity å¼€å‘ä¸­ï¼Œä½¿ç”¨ Lua è¿›è¡Œä»£ç çƒ­æ›´æ–°å’Œè¡¥ä¸çš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š  

### **æ–¹å¼ 1ï¼šä½¿ç”¨ Lua ä¿®å¤ C# ä»£ç ä¸­çš„ Bug**
è¿™ç§æ–¹å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**è®© C# ä»£ç è°ƒç”¨ Lua ä»£ç ï¼Œåœ¨ Lua å±‚ä¿®å¤ Bugï¼Œè€Œä¸éœ€è¦é‡æ–°æ‰“åŒ…æ•´ä¸ªåº”ç”¨**ã€‚

#### **å®ç°æµç¨‹**
1. **åœ¨ C# ä»£ç ä¸­é¢„ç•™ Lua è°ƒç”¨å…¥å£**
   - é€šè¿‡ `xlua` æˆ– `tolua` æ¡†æ¶ï¼Œåœ¨ C# ä¸­åŠ è½½å¹¶æ‰§è¡Œ Lua è„šæœ¬ã€‚

2. **åœ¨ Lua ä¸­å®šä¹‰ä¿®å¤é€»è¾‘**
   - é€šè¿‡ `xlua.hotfix` æˆ– `xlua.override` ç›´æ¥ä¿®æ”¹ C# ç±»ä¸­çš„æ–¹æ³•ï¼ˆxlua æ–¹å¼ï¼‰ã€‚
   - æˆ–è€…è®© C# è°ƒç”¨ Lua ä¸­æ–°çš„ä¿®å¤é€»è¾‘ï¼Œæ›¿æ¢åŸæœ‰é€»è¾‘ï¼ˆtolua æ–¹å¼ï¼‰ã€‚

3. **é€šè¿‡æœåŠ¡å™¨ä¸‹å‘æ–°çš„ Lua è„šæœ¬**
   - æœåŠ¡å™¨å‘å¸ƒæ–°çš„ä¿®å¤è„šæœ¬ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯ä¸‹è½½åæ›¿æ¢è€çš„ Lua ä»£ç ã€‚

4. **åº”ç”¨è¡¥ä¸**
   - é‡æ–°åŠ è½½ Lua ä»£ç ï¼Œè®©ä¿®å¤é€»è¾‘ç”Ÿæ•ˆï¼Œæ— éœ€é‡æ–°ç¼–è¯‘ C# ä»£ç ã€‚

#### **ç¤ºä¾‹ä»£ç **
**C# ä»£ç ï¼ˆåŸå§‹ä»£ç å­˜åœ¨ Bugï¼‰**
```csharp
public class Player
{
    public int GetDamage(int baseDamage)
    {
        // è¿™é‡Œçš„ Bug æ˜¯æ²¡æœ‰ä¹˜ä»¥æ”»å‡»åŠ›ç³»æ•°
        return baseDamage;
    }
}
```

**Lua ä»£ç ï¼ˆä¿®å¤ Bugï¼Œä½¿ç”¨ xlua.hotfixï¼‰**
```lua
xlua.hotfix(CS.Player, "GetDamage", function(self, baseDamage)
    local attackMultiplier = 1.5  -- å‡è®¾æ”»å‡»åŠ›ç³»æ•°æ˜¯ 1.5
    return baseDamage * attackMultiplier
end)
```
è¿™æ ·ï¼Œå½“ `Player:GetDamage(100)` è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šè¿”å› `150` è€Œä¸æ˜¯ `100`ã€‚

---

### **æ–¹å¼ 2ï¼šç›´æ¥ä½¿ç”¨ Lua ç¼–å†™ä¸šåŠ¡é€»è¾‘**
è¿™ç§æ–¹å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**æ¸¸æˆçš„æ ¸å¿ƒé€»è¾‘ä½¿ç”¨ Lua ç¼–å†™ï¼Œè€Œ C# ä»…ä½œä¸ºåº•å±‚å°è£…ï¼Œå¤„ç† Unity API è°ƒç”¨**ã€‚

#### **å®ç°æµç¨‹**
1. **C# ä»£ç æä¾› Lua æ‰§è¡Œç¯å¢ƒ**
   - ä½¿ç”¨ `xlua` æˆ– `tolua` åŠ è½½ Lua ä»£ç ã€‚
   - C# æä¾› Lua éœ€è¦è°ƒç”¨çš„ APIï¼Œæ¯”å¦‚ç‰©ç†ã€æ¸²æŸ“ã€UI æ“ä½œç­‰ã€‚

2. **Lua ä»£ç ç¼–å†™ä¸šåŠ¡é€»è¾‘**
   - ä¸»è¦ç¼–å†™æ¸¸æˆæ ¸å¿ƒé€»è¾‘ï¼Œæ¯”å¦‚è§’è‰²è¡Œä¸ºã€æˆ˜æ–—è®¡ç®—ã€å‰§æƒ…è„šæœ¬ç­‰ã€‚

3. **é€šè¿‡æœåŠ¡å™¨ä¸‹å‘ Lua æ›´æ–°**
   - æœåŠ¡å™¨å‘å¸ƒæ–°çš„ Lua é€»è¾‘ï¼Œå®¢æˆ·ç«¯ä¸‹è½½åç›´æ¥æ‰§è¡Œã€‚

4. **çƒ­æ›´æ–°é€»è¾‘**
   - é€šè¿‡é‡æ–°åŠ è½½ Lua ä»£ç ï¼ŒåŠ¨æ€ä¿®æ”¹æ¸¸æˆè¡Œä¸ºã€‚

#### **ç¤ºä¾‹ä»£ç **
**C# ä»£ç ï¼ˆåŠ è½½ Lua è„šæœ¬ï¼‰**
```csharp
using XLua;
using System.Collections;
using UnityEngine;

public class LuaManager : MonoBehaviour
{
    private LuaEnv luaEnv = new LuaEnv();

    void Start()
    {
        luaEnv.DoString("require 'GameLogic'"); // åŠ è½½ Lua ä¸šåŠ¡é€»è¾‘
    }

    void OnDestroy()
    {
        luaEnv.Dispose();
    }
}
```

**Lua ä»£ç ï¼ˆå®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ï¼‰**
```lua
-- GameLogic.lua
Player = {}

function Player:new(o, name, hp)
    o = o or {}
    setmetatable(o, self)
    self.__index = self
    self.name = name or "Hero"
    self.hp = hp or 100
    return o
end

function Player:TakeDamage(damage)
    self.hp = self.hp - damage
    print(self.name .. " takes " .. damage .. " damage, HP: " .. self.hp)
end

-- åˆ›å»ºè§’è‰²
hero = Player:new(nil, "Knight", 200)
hero:TakeDamage(30) -- "Knight takes 30 damage, HP: 170"
```

è¿™æ ·ï¼Œå¦‚æœåç»­éœ€è¦ä¿®æ”¹ `TakeDamage` è®¡ç®—è§„åˆ™ï¼Œåªéœ€è¦çƒ­æ›´æ–° `GameLogic.lua` æ–‡ä»¶ã€‚

---

### **æ–¹å¼ 1 å’Œ æ–¹å¼ 2 çš„åŒºåˆ«åˆ†æ**
|  | **æ–¹å¼ 1ï¼ˆä¿®å¤ C# Bugï¼‰** | **æ–¹å¼ 2ï¼ˆLua ä¸šåŠ¡é€»è¾‘ï¼‰** |
|---|---|---|
| **ç”¨é€”** | ä¿®å¤ C# ä»£ç ä¸­çš„ Bug | ç›´æ¥ç”¨ Lua ç¼–å†™æ¸¸æˆé€»è¾‘ |
| **ä¿®æ”¹çš„çµæ´»æ€§** | åªèƒ½ä¿®æ”¹å·²æœ‰ C# ä»£ç ä¸­çš„ Bug | å¯ä»¥éšæ—¶ä¿®æ”¹æ¸¸æˆç©æ³• |
| **å¯¹ C# ä¾èµ–** | ä¾èµ–åŸæœ‰ C# ä»£ç  | ä¸šåŠ¡é€»è¾‘å®Œå…¨ç”¨ Lua å®ç° |
| **æ€§èƒ½** | å½±å“è¾ƒå°ï¼Œåªä¿®å¤ Bug | å¯èƒ½å½±å“æ€§èƒ½ï¼ŒLua è¿è¡Œæ¯” C# æ…¢ |
| **é€‚ç”¨åœºæ™¯** | å°è§„æ¨¡ Hotfixï¼Œä¸å½±å“æ¶æ„ | éœ€è¦é•¿æœŸç»´æŠ¤ã€é¢‘ç¹è°ƒæ•´çš„æ¸¸æˆé€»è¾‘ |
| **éš¾åº¦** | ç®€å•ï¼Œä½¿ç”¨ `xlua.hotfix` ç›´æ¥æ›¿æ¢ | å¤æ‚ï¼Œéœ€è¦è®¾è®¡ Lua å’Œ C# äº¤äº’æœºåˆ¶ |

### **ä¼˜åŠ£åˆ†æ**
- **æ–¹å¼ 1ï¼ˆä¿®å¤ C# Bugï¼‰**
  - âœ… **ä¼˜ç‚¹**ï¼šæ”¹åŠ¨å°ï¼Œä¸å½±å“ç°æœ‰æ¶æ„ï¼Œçƒ­ä¿®å¤æˆæœ¬ä½ã€‚
  - âŒ **ç¼ºç‚¹**ï¼šåªèƒ½ä¿®è¡¥ C# ä»£ç ï¼Œä¸èƒ½æ”¹å˜å¤§çš„ä¸šåŠ¡é€»è¾‘ã€‚

- **æ–¹å¼ 2ï¼ˆLua ä¸šåŠ¡é€»è¾‘ï¼‰**
  - âœ… **ä¼˜ç‚¹**ï¼šæ›´æ–°çµæ´»ï¼Œé€»è¾‘æ”¹åŠ¨æ— éœ€é‡æ–°ç¼–è¯‘ C#ï¼Œé€‚åˆé•¿å‘¨æœŸè¿è¥çš„æ¸¸æˆã€‚
  - âŒ **ç¼ºç‚¹**ï¼šLua è¿è¡Œæ•ˆç‡ä½äº C#ï¼Œæ¶‰åŠå¤§é‡ C# API æ—¶å¯èƒ½æœ‰æ€§èƒ½é—®é¢˜ã€‚

---

### **æ€»ç»“**
- å¦‚æœæ¸¸æˆå·²ç»å®Œæˆå¼€å‘ï¼Œåªæ˜¯æƒ³ä¿®å¤ Bugï¼Œè€Œä¸å½±å“æ¶æ„ï¼Œ**æ–¹å¼ 1ï¼ˆä¿®å¤ C# Bugï¼‰** æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚
- å¦‚æœæ¸¸æˆé€»è¾‘éœ€è¦é¢‘ç¹è°ƒæ•´ï¼Œæ¯”å¦‚ç­–åˆ’å¸Œæœ›å¿«é€Ÿä¿®æ”¹æ•°å€¼ã€æŠ€èƒ½é€»è¾‘ã€å…³å¡è§„åˆ™ç­‰ï¼Œ**æ–¹å¼ 2ï¼ˆLua ä¸šåŠ¡é€»è¾‘ï¼‰** æ›´åˆé€‚ã€‚
- ä¸€äº›æˆç†Ÿçš„æ¸¸æˆé€šå¸¸**ç»“åˆä½¿ç”¨**ï¼š
  - **C# å¤„ç†åº•å±‚ã€æ€§èƒ½å…³é”®çš„é€»è¾‘**ã€‚
  - **Lua è´Ÿè´£é«˜å±‚ä¸šåŠ¡é€»è¾‘å’Œçƒ­æ›´æ–°**ã€‚

ä½ æ›´å€¾å‘äºå“ªç§æ–¹å¼ï¼Œæˆ–è€…ä½ å½“å‰çš„é¡¹ç›®æœ‰ä»€ä¹ˆå…·ä½“éœ€æ±‚ï¼Ÿ




### **å¦‚ä½•åœ¨ Lua ä¸­è°ƒç”¨ Unity API**  
åœ¨ Unity ä¸­ï¼ŒLua ä¸èƒ½ç›´æ¥è°ƒç”¨ Unity APIï¼Œè€Œæ˜¯éœ€è¦ C# æä¾›æ¡¥æ¥ä»£ç ï¼ŒæŠŠ Unity æä¾›çš„åŠŸèƒ½æ³¨å†Œåˆ° Lua ç¯å¢ƒä¸­ã€‚å¸¸è§çš„æ–¹æ³•æœ‰ï¼š  

1. **ç›´æ¥æ˜ å°„ C# ç±»åˆ° Luaï¼ˆä½¿ç”¨ `XLua` æˆ– `ToLua`ï¼‰**
2. **é€šè¿‡ C# æä¾› Lua å¯è°ƒç”¨çš„å°è£… API**
3. **Lua è°ƒç”¨ C# äº‹ä»¶ã€åç¨‹ç­‰åŠŸèƒ½**

---

## **æ–¹æ³• 1ï¼šç›´æ¥æ˜ å°„ C# ç±»åˆ° Lua**
`XLua` å’Œ `ToLua` å…è®¸ Lua ç›´æ¥è°ƒç”¨ C# ç±»ï¼Œæ— éœ€æ‰‹åŠ¨ç»‘å®šã€‚ä¾‹å¦‚ï¼š  

### **ç¤ºä¾‹ï¼šåœ¨ Lua ä¸­ä½¿ç”¨ Unity API æ§åˆ¶ GameObject**
**C# ä»£ç ï¼ˆåˆå§‹åŒ– Lua ç¯å¢ƒï¼‰**
```csharp
using UnityEngine;
using XLua;

public class LuaScriptRunner : MonoBehaviour
{
    private LuaEnv luaEnv = new LuaEnv();

    void Start()
    {
        luaEnv.DoString(@"
            local obj = CS.UnityEngine.GameObject('LuaCreatedObject')
            obj.transform.position = CS.UnityEngine.Vector3(1, 2, 3)
            print('GameObject created at:', obj.transform.position)
        ");
    }

    void OnDestroy()
    {
        luaEnv.Dispose();
    }
}
```
**Lua ä»£ç ï¼ˆç›´æ¥è°ƒç”¨ Unity APIï¼‰**
```lua
local obj = CS.UnityEngine.GameObject("MyObject")
obj.transform.position = CS.UnityEngine.Vector3(1, 2, 3)
```
âœ… è¿™é‡Œ `CS.UnityEngine.GameObject` è®© Lua ç›´æ¥è®¿é—® Unity çš„ `GameObject` APIã€‚

---

## **æ–¹æ³• 2ï¼šé€šè¿‡ C# æä¾› Lua å¯è°ƒç”¨çš„å°è£… API**
æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸æƒ³è®© Lua ç›´æ¥è®¿é—® Unity APIï¼Œè€Œæ˜¯é€šè¿‡ C# æä¾›æ›´å®‰å…¨çš„æ¥å£ã€‚ä¾‹å¦‚ï¼š

### **ç¤ºä¾‹ï¼šLua æ§åˆ¶è§’è‰²ç§»åŠ¨**
**C# ä»£ç ï¼ˆæä¾› Lua å¯è°ƒç”¨çš„ APIï¼‰**
```csharp
using UnityEngine;
using XLua;

[LuaCallCSharp]
public class PlayerController : MonoBehaviour
{
    public void Move(Vector3 direction)
    {
        transform.position += direction;
    }
}
```
**Lua ä»£ç ï¼ˆé€šè¿‡å°è£… API æ§åˆ¶è§’è‰²ï¼‰**
```lua
local player = CS.UnityEngine.GameObject.Find("Player"):GetComponent("PlayerController")
player:Move(CS.UnityEngine.Vector3(0, 1, 0)) -- è®©è§’è‰²å‘ä¸Šç§»åŠ¨ 1 å•ä½
```
âœ… è¿™æ ·å¯ä»¥æ§åˆ¶å“ªäº› Unity åŠŸèƒ½æš´éœ²ç»™ Luaï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚

---

## **æ–¹æ³• 3ï¼šLua è°ƒç”¨ C# äº‹ä»¶ã€åç¨‹ç­‰**
**ç¤ºä¾‹ï¼šåœ¨ Lua ä¸­ç­‰å¾… 2 ç§’åæ‰§è¡Œä»£ç **
**C# ä»£ç ï¼ˆå°è£…åç¨‹ä¾› Lua ä½¿ç”¨ï¼‰**
```csharp
using UnityEngine;
using XLua;
using System.Collections;

[LuaCallCSharp]
public class CoroutineHelper : MonoBehaviour
{
    public void StartLuaCoroutine(LuaFunction luaFunc)
    {
        StartCoroutine(RunLuaCoroutine(luaFunc));
    }

    private IEnumerator RunLuaCoroutine(LuaFunction luaFunc)
    {
        yield return new WaitForSeconds(2);
        luaFunc.Call();
    }
}
```
**Lua ä»£ç ï¼ˆä½¿ç”¨ C# åç¨‹ç­‰å¾… 2 ç§’ï¼‰**
```lua
local coroutineHelper = CS.UnityEngine.GameObject.Find("CoroutineHelper"):GetComponent("CoroutineHelper")

coroutineHelper:StartLuaCoroutine(function()
    print("Waited 2 seconds!")
end)
```
âœ… è®© Lua ä½¿ç”¨ Unity çš„åç¨‹ç³»ç»Ÿï¼Œé¿å…æ€§èƒ½é—®é¢˜ã€‚

---

## **Lua åœ¨ Unity ä¸­çš„åº”ç”¨åœºæ™¯**
### 1. **æ¸¸æˆé€»è¾‘çƒ­æ›´æ–°**
   - ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æŠ€èƒ½è®¡ç®—ã€AI é€»è¾‘ï¼‰ç”¨ Lua ç¼–å†™ï¼Œéšæ—¶çƒ­æ›´æ–°ï¼Œæ— éœ€é‡æ–°æ‰“åŒ…ã€‚
   - C# æä¾› Lua æ‰§è¡Œç¯å¢ƒï¼Œä¿éšœæ€§èƒ½å…³é”®éƒ¨åˆ†è¿è¡Œç¨³å®šã€‚

### 2. **ç­–åˆ’é…ç½®é©±åŠ¨**
   - ç­–åˆ’ç”¨ Lua ç¼–å†™å…³å¡ã€æŠ€èƒ½ã€ä»»åŠ¡é€»è¾‘ã€‚
   - ä¾‹å¦‚ï¼Œ`QuestSystem.lua` å®šä¹‰ä»»åŠ¡é€»è¾‘ï¼Œä¿®æ”¹ Lua æ–‡ä»¶å³å¯è°ƒæ•´ä»»åŠ¡è§„åˆ™ã€‚

### 3. **UI é€»è¾‘**
   - C# å¤„ç† UI æ¸²æŸ“ï¼ŒLua è´Ÿè´£ UI äº¤äº’é€»è¾‘ã€‚
   - ä¾‹å¦‚ï¼š
     ```lua
     local button = CS.UnityEngine.GameObject.Find("StartButton"):GetComponent("Button")
     button.onClick:AddListener(function() print("Game Start!") end)
     ```

### 4. **AI è¡Œä¸ºæ ‘**
   - Lua è´Ÿè´£ AI é€»è¾‘ï¼ŒC# æä¾›è¡Œä¸ºæ¥å£ã€‚
   - ä¾‹å¦‚ï¼š
     ```lua
     function Enemy:Update()
         if self.hp < 50 then
             self:Retreat()
         else
             self:Attack()
         end
     end
     ```

### 5. **æˆ˜æ–—ç³»ç»Ÿ**
   - æœåŠ¡å™¨ä¸‹å‘æ–°çš„ Lua è„šæœ¬ï¼Œå®ç°æŠ€èƒ½è°ƒæ•´ï¼Œè€Œä¸ç”¨ä¿®æ”¹ C# ä»£ç ã€‚




# å­¦ä¹ ç¬”è®°- **ç‚¹å· (`.`) å’Œå†’å· (`:`)** çš„ä¸»è¦åŒºåˆ«

åœ¨ Lua é‡Œï¼Œ**ç‚¹å· (`.`) å’Œå†’å· (`:`)** çš„ä¸»è¦åŒºåˆ«åœ¨äº**æ–¹æ³•è°ƒç”¨æ—¶æ˜¯å¦éšå¼ä¼ é€’ `self`**ã€‚å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

---

## **1. `.`ï¼ˆç‚¹å·ï¼‰â€”â€” ç›´æ¥è®¿é—®è¡¨ä¸­çš„å­—æ®µæˆ–å‡½æ•°**
- é€‚ç”¨äº**æ™®é€šå‡½æ•°**ï¼Œè°ƒç”¨æ—¶éœ€è¦**æ‰‹åŠ¨ä¼ é€’ `self`ï¼ˆå¦‚æœéœ€è¦ï¼‰**
- ç›´æ¥è®¿é—®è¡¨ä¸­çš„å±æ€§æˆ–å‡½æ•°ï¼Œä¸è‡ªåŠ¨ä¼ é€’ `self`

### **ç¤ºä¾‹**
```lua
local MyClass = {}

-- å®šä¹‰ä¸€ä¸ªæ–¹æ³•
function MyClass.sayHello(self)
    print("Hello, " .. self.name)
end

-- åˆ›å»ºå¯¹è±¡
local obj = { name = "Lua" }
setmetatable(obj, { __index = MyClass })

-- ä½¿ç”¨ `.` è®¿é—®æ–¹æ³•æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ä¼ é€’ `self`
MyClass.sayHello(obj)  -- âœ… è¾“å‡º: Hello, Lua
```
**åˆ†æ**
- `MyClass.sayHello(obj)` éœ€è¦**æ‰‹åŠ¨ä¼ é€’ `obj`** ä½œä¸º `self`ã€‚

---

## **2. `:`ï¼ˆå†’å·ï¼‰â€”â€” è¯­æ³•ç³–ï¼Œè‡ªåŠ¨ä¼ é€’ `self`**
- **æ–¹æ³•è°ƒç”¨**ä¸“ç”¨
- `obj:method(...)` ç­‰ä»·äº `obj.method(obj, ...)`
- **è‡ªåŠ¨ä¼ é€’ `self` å‚æ•°**

### **ç¤ºä¾‹**
```lua
local MyClass = {}

-- å®šä¹‰ä¸€ä¸ªæ–¹æ³•
function MyClass:sayHello()
    print("Hello, " .. self.name)
end

-- åˆ›å»ºå¯¹è±¡
local obj = { name = "Lua" }
setmetatable(obj, { __index = MyClass })

-- ä½¿ç”¨ `:` è®¿é—®æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨ä¼ é€’ `self`
obj:sayHello()  -- âœ… è¾“å‡º: Hello, Lua
```
**ç­‰ä»·äº**
```lua
obj.sayHello(obj)
```
**åˆ†æ**
- `obj:sayHello()` è‡ªåŠ¨å°† `obj` ä½œä¸º `self` ä¼ å…¥ï¼Œæ— éœ€æ‰‹åŠ¨ä¼ é€’ã€‚

---

## **3. ç‚¹å· `.` vs. å†’å· `:` çš„åŒºåˆ«æ€»ç»“**
|  | **ç‚¹å· `.`** | **å†’å· `:`** |
|---|---|---|
| **ä½œç”¨** | è®¿é—®è¡¨çš„å­—æ®µæˆ–å‡½æ•° | è°ƒç”¨æ–¹æ³•ï¼Œå¹¶è‡ªåŠ¨ä¼  `self` |
| **æ˜¯å¦ä¼  `self`** | éœ€è¦æ‰‹åŠ¨ä¼ é€’ | è‡ªåŠ¨ä¼ é€’ |
| **å¸¸è§é”™è¯¯** | å¿˜è®°ä¼  `self`ï¼Œå¯¼è‡´ `nil` é”™è¯¯ | ä¸é€‚ç”¨äºéæ–¹æ³•çš„æƒ…å†µ |
| **ç¤ºä¾‹** | `obj.func(obj, ...)` | `obj:func(...)` (ç­‰ä»·äº `obj.func(obj, ...)`) |

---

## **4. å¸¸è§é”™è¯¯**
### **âŒ ä½¿ç”¨ `.` è°ƒç”¨æ–¹æ³•ä½†å¿˜è®° `self`**
```lua
obj.sayHello()  -- âŒ æŠ¥é”™: attempt to concatenate a nil value
```
**æ­£ç¡®åšæ³•**
```lua
obj.sayHello(obj)  -- âœ… æ‰‹åŠ¨ä¼ é€’ self
obj:sayHello()  -- âœ… æ¨èï¼šç”¨ `:` è¯­æ³•ç³–
```

### **âŒ ä½¿ç”¨ `:` è°ƒç”¨æ™®é€šå‡½æ•°**
```lua
function greet(name)
    print("Hello, " .. name)
end

greet:("Lua")  -- âŒ æŠ¥é”™: attempt to index a function value
```
**æ­£ç¡®åšæ³•**
```lua
greet("Lua")  -- âœ…
```

---

## **5. ç»“è®º**
- **ç‚¹å· `.`** ç”¨äº**æ™®é€šå‡½æ•°è°ƒç”¨**ï¼Œéœ€è¦æ‰‹åŠ¨ä¼  `self`
- **å†’å· `:`** ç”¨äº**æ–¹æ³•è°ƒç”¨**ï¼Œä¼šè‡ªåŠ¨ä¼  `self`ï¼Œæ¨èä½¿ç”¨
- **æ¨èï¼šæ–¹æ³•å®šä¹‰æ—¶ä½¿ç”¨ `:`ï¼Œè°ƒç”¨æ—¶ä¹Ÿä½¿ç”¨ `:`ï¼Œé¿å… `self` ä¼ é€’é”™è¯¯**

**âœ… æ¨èå†™æ³•**
```lua
function MyClass:sayHello()
    print("Hello, " .. self.name)
end
obj:sayHello()  -- è‡ªåŠ¨ä¼ é€’ self
```

å¸Œæœ›è¿™ä¸ªè§£é‡Šæ¸…æ¥šäº† `.` å’Œ `:` çš„åŒºåˆ«ï¼ğŸ˜ƒ

# lua ä¸ C#å·®å¼‚

Lua å’Œ C# åœ¨è¯­æ³•ä¸Šçš„ä¸»è¦åŒºåˆ«ä½“ç°åœ¨**å˜é‡å£°æ˜ã€æ•°æ®ç±»å‹ã€æ§åˆ¶æµã€å‡½æ•°å®šä¹‰ã€é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ã€é”™è¯¯å¤„ç†**ç­‰æ–¹é¢ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„ä¸»è¦å·®å¼‚åˆ†æï¼š

---

## **1. å˜é‡ä¸æ•°æ®ç±»å‹**
### **Lua**
- **åŠ¨æ€ç±»å‹**ï¼ˆå˜é‡çš„ç±»å‹ç”±èµ‹å€¼å†³å®šï¼‰
- **å˜é‡ä¸éœ€è¦å£°æ˜ç±»å‹**
- **`nil` ä»£è¡¨æœªåˆå§‹åŒ–çš„å˜é‡**

```lua
x = 10        -- è‡ªåŠ¨æ¨æ–­ä¸º number
y = "hello"   -- è‡ªåŠ¨æ¨æ–­ä¸º string
z = nil       -- nil è¡¨ç¤ºå˜é‡æœªèµ‹å€¼

print(type(x))  -- è¾“å‡º: number
print(type(y))  -- è¾“å‡º: string
print(type(z))  -- è¾“å‡º: nil
```

### **C#**
- **é™æ€ç±»å‹**ï¼ˆå˜é‡ç±»å‹å¿…é¡»æ˜ç¡®ï¼‰
- **å˜é‡å¿…é¡»å£°æ˜ç±»å‹**
- **`null` ä»£è¡¨å¼•ç”¨ç±»å‹æœªåˆå§‹åŒ–**

```csharp
int x = 10;         // æ˜ç¡®ç±»å‹
string y = "hello"; // æ˜ç¡®ç±»å‹
object z = null;    // null è¡¨ç¤ºå¼•ç”¨ä¸ºç©º

Console.WriteLine(x.GetType());  // è¾“å‡º: System.Int32
Console.WriteLine(y.GetType());  // è¾“å‡º: System.String
Console.WriteLine(z == null);    // è¾“å‡º: True
```

âœ… **åŒºåˆ«**ï¼š
- Lua **ä¸éœ€è¦å£°æ˜å˜é‡ç±»å‹**ï¼ŒC# éœ€è¦ã€‚
- Lua **å˜é‡é»˜è®¤æ˜¯å…¨å±€çš„**ï¼ˆé™¤éåŠ  `local`ï¼‰ï¼ŒC# å˜é‡æœ‰ä½œç”¨åŸŸæ§åˆ¶ã€‚

---

## **2. å˜é‡ä½œç”¨åŸŸ**
### **Lua**
- é»˜è®¤å˜é‡æ˜¯**å…¨å±€å˜é‡**
- **å±€éƒ¨å˜é‡**éœ€è¦ `local` å…³é”®å­—

```lua
x = 10      -- å…¨å±€å˜é‡
local y = 20  -- å±€éƒ¨å˜é‡

function test()
    local z = 30  -- å±€éƒ¨å˜é‡
end
```

### **C#**
- å˜é‡**é»˜è®¤æ˜¯å±€éƒ¨å˜é‡**
- ä½œç”¨åŸŸç”± `{}` æ§åˆ¶
- `public`ã€`private` æ§åˆ¶è®¿é—®æƒé™

```csharp
int x = 10;  // å±€éƒ¨å˜é‡

class Example {
    private int y = 20;  // ç±»çš„ç§æœ‰å˜é‡
}
```

âœ… **åŒºåˆ«**ï¼š
- Lua é»˜è®¤æ˜¯**å…¨å±€å˜é‡**ï¼ŒC# é»˜è®¤æ˜¯**å±€éƒ¨å˜é‡**ã€‚
- Lua éœ€è¦ `local` å£°æ˜å±€éƒ¨å˜é‡ï¼Œè€Œ C# ç›´æ¥åœ¨æ–¹æ³•/ç±»å†…å®šä¹‰å³å¯ã€‚

---

## **3. æ§åˆ¶æµ**
### **Lua**
- `if` è¯­å¥ä¸­**å¿…é¡»æ˜¾å¼å†™ `then` å’Œ `end`**
- `elseif` **æ˜¯ä¸€ä¸ªå•è¯**
- `for` è¯­å¥æœ‰**æ•°å€¼ `for` å’Œæ³›å‹ `for`**
- `repeat...until` ç±»ä¼¼ `do...while`

```lua
x = 10

if x > 5 then
    print("x å¤§äº 5")
elseif x == 5 then
    print("x ç­‰äº 5")
else
    print("x å°äº 5")
end
```

### **C#**
- `if` è¯­å¥**ä¸éœ€è¦ `then` å’Œ `end`**
- `else if` æ˜¯**ä¸¤ä¸ªå•è¯**
- `for` è¯­å¥åªèƒ½ä½¿ç”¨ç´¢å¼•è®¡æ•°æˆ– `foreach`
- `do...while` è¯­æ³•ä¸ `while` ç±»ä¼¼

```csharp
int x = 10;

if (x > 5) {
    Console.WriteLine("x å¤§äº 5");
} else if (x == 5) {
    Console.WriteLine("x ç­‰äº 5");
} else {
    Console.WriteLine("x å°äº 5");
}
```

âœ… **åŒºåˆ«**ï¼š
- Lua éœ€è¦ `then` å’Œ `end`ï¼ŒC# éœ€è¦ `{}`ã€‚
- Lua ç”¨ `elseif`ï¼ŒC# ç”¨ `else if`ã€‚

---

## **4. å¾ªç¯**
### **Lua**
```lua
for i = 1, 5 do
    print(i)
end

-- æ³›å‹ for éå†è¡¨
t = { "A", "B", "C" }
for k, v in ipairs(t) do
    print(k, v)
end
```

### **C#**
```csharp
for (int i = 1; i <= 5; i++) {
    Console.WriteLine(i);
}

// éå†æ•°ç»„
string[] t = { "A", "B", "C" };
foreach (var item in t) {
    Console.WriteLine(item);
}
```

âœ… **åŒºåˆ«**ï¼š
- Lua `for` è¯­å¥ç”¨ `do...end`ï¼ŒC# ç”¨ `{}`ã€‚
- Lua `for` å¯ä»¥ç›´æ¥éå†è¡¨ï¼ŒC# ä½¿ç”¨ `foreach`ã€‚

---

## **5. å‡½æ•°**
### **Lua**
```lua
function add(a, b)
    return a + b
end

print(add(3, 5))  -- è¾“å‡º: 8
```

### **C#**
```csharp
int Add(int a, int b) {
    return a + b;
}

Console.WriteLine(Add(3, 5));  // è¾“å‡º: 8
```

âœ… **åŒºåˆ«**ï¼š
- Lua **ä¸éœ€è¦å£°æ˜è¿”å›å€¼ç±»å‹**ï¼ŒC# éœ€è¦ã€‚
- C# **å¿…é¡»å†™ `return` ç±»å‹**ï¼ŒLua æ²¡æœ‰å¼ºåˆ¶è¦æ±‚ã€‚

---

## **6. é¢å‘å¯¹è±¡**
### **Lua**
- æ²¡æœ‰ç±»å’Œå¯¹è±¡çš„åŸç”Ÿæ¦‚å¿µï¼Œä½†å¯ä»¥ç”¨ `table` + `metatable` å®ç°
```lua
Person = {}
Person.__index = Person

function Person:new(name)
    local obj = setmetatable({}, self)
    obj.name = name
    return obj
end

function Person:sayHello()
    print("Hello, my name is " .. self.name)
end

local p = Person:new("Alice")
p:sayHello()  -- è¾“å‡º: Hello, my name is Alice
```

### **C#**
- ç›´æ¥æ”¯æŒç±»å’Œå¯¹è±¡
```csharp
class Person {
    public string Name;

    public Person(string name) {
        Name = name;
    }

    public void SayHello() {
        Console.WriteLine("Hello, my name is " + Name);
    }
}

Person p = new Person("Alice");
p.SayHello();  // è¾“å‡º: Hello, my name is Alice
```

âœ… **åŒºåˆ«**ï¼š
- Lua **æ²¡æœ‰ç±»**ï¼Œä½†å¯ä»¥ç”¨ `table` + `metatable` å®ç°ã€‚
- C# ç›´æ¥æ”¯æŒç±»ï¼Œè¯­æ³•æ›´æ¸…æ™°ã€‚

---

## **7. é”™è¯¯å¤„ç†**
### **Lua**
- ä½¿ç”¨ `pcall` æˆ– `xpcall` æ•è·é”™è¯¯
```lua
function errorFunc()
    error("å‘ç”Ÿé”™è¯¯ï¼")
end

local status, err = pcall(errorFunc)
if not status then
    print("æ•è·é”™è¯¯ï¼š" .. err)
end
```

### **C#**
- ä½¿ç”¨ `try-catch` å¤„ç†å¼‚å¸¸
```csharp
try {
    throw new Exception("å‘ç”Ÿé”™è¯¯ï¼");
} catch (Exception ex) {
    Console.WriteLine("æ•è·é”™è¯¯ï¼š" + ex.Message);
}
```

âœ… **åŒºåˆ«**ï¼š
- Lua ç”¨ `pcall` è¿›è¡Œé”™è¯¯æ•è·ï¼ŒC# ç”¨ `try-catch`ã€‚
- C# çš„å¼‚å¸¸ç³»ç»Ÿæ›´å¼ºå¤§ï¼Œæ”¯æŒä¸åŒç±»å‹çš„å¼‚å¸¸ã€‚

---

## **æ€»ç»“**
| **ç‰¹æ€§** | **Lua** | **C#** |
|---|---|---|
| **ç±»å‹** | åŠ¨æ€ç±»å‹ | é™æ€ç±»å‹ |
| **å˜é‡ä½œç”¨åŸŸ** | é»˜è®¤å…¨å±€ï¼Œéœ€ `local` | é»˜è®¤å±€éƒ¨ |
| **æ§åˆ¶æµ** | `then...end` è¯­æ³• | `{}` è¯­æ³• |
| **å¾ªç¯** | `for i = 1, 10 do` | `for (int i = 1; i <= 10; i++)` |
| **å‡½æ•°** | `function f()` | `int Func()` |
| **OOP** | `table` + `metatable` | ç›´æ¥æ”¯æŒ `class` |
| **é”™è¯¯å¤„ç†** | `pcall(x)` | `try-catch` |

æ€»çš„æ¥è¯´ï¼Œ**Lua æ›´è½»é‡ã€çµæ´»ï¼ŒC# æ›´å¼ºå¤§ã€ç»“æ„åŒ–**ã€‚


# æ­£åˆ™è¡¨è¾¾å¼

Lua ä½¿ç”¨ `string.gsub`ã€`string.find`ã€`string.match` ç­‰å‡½æ•°æ”¯æŒ**æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼‰**ï¼Œè¿™ç±»ä¼¼äºæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½† Lua ä½¿ç”¨çš„æ˜¯**ç‹¬ç‰¹çš„æ¨¡å¼åŒ¹é…è§„åˆ™**ï¼Œå¹¶ä¸å®Œå…¨å…¼å®¹æ ‡å‡†æ­£åˆ™è¡¨è¾¾å¼ã€‚  

---

## **1. åŸºæœ¬å­—ç¬¦åŒ¹é…è§„åˆ™**
Lua çš„æ¨¡å¼åŒ¹é…æ”¯æŒä»¥ä¸‹ç‰¹æ®Šå­—ç¬¦ï¼š
| ç¬¦å· | ä½œç”¨ |
|------|------|
| `.`  | åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆæ¢è¡Œç¬¦ `\n` é™¤å¤–ï¼‰ |
| `%a` | åŒ¹é…ä»»æ„å­—æ¯ï¼ˆA-Z, a-zï¼‰ |
| `%d` | åŒ¹é…ä»»æ„æ•°å­—ï¼ˆ0-9ï¼‰ |
| `%l` | åŒ¹é…å°å†™å­—æ¯ï¼ˆa-zï¼‰ |
| `%u` | åŒ¹é…å¤§å†™å­—æ¯ï¼ˆA-Zï¼‰ |
| `%s` | åŒ¹é…ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œï¼‰ |
| `%w` | åŒ¹é…å­—æ¯+æ•°å­—ï¼ˆA-Z, a-z, 0-9ï¼‰ |
| `%x` | åŒ¹é…åå…­è¿›åˆ¶å­—ç¬¦ï¼ˆ0-9, A-F, a-fï¼‰ |
| `%c` | åŒ¹é…æ§åˆ¶å­—ç¬¦ï¼ˆå¦‚ `\n`ã€`\t`ï¼‰ |
| `%p` | åŒ¹é…æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚ `.,!?`ï¼‰ |
| `%z` | åŒ¹é… `\0`ï¼ˆnull å­—ç¬¦ï¼‰ |
| `%f[set]` | åŒ¹é… `set` å®šä¹‰çš„**è¾¹ç•Œ** |

**ç¤ºä¾‹**
```lua
print(string.match("hello 123", "%a+"))  --> hello
print(string.match("hello 123", "%d+"))  --> 123
```

---

## **2. è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦**
Lua ä½¿ç”¨ `%` ä½œä¸ºè½¬ä¹‰ç¬¦ï¼Œè€Œä¸æ˜¯ `\`ï¼š
| ç¬¦å· | ä½œç”¨ |
|------|------|
| `%.` | åŒ¹é… `.` |
| `%+` | åŒ¹é… `+` |
| `%*` | åŒ¹é… `*` |
| `%?` | åŒ¹é… `?` |
| `%(`, `%)` | åŒ¹é… `()` |
| `%[` , `%]` | åŒ¹é… `[]` |
| `%^` | åŒ¹é… `^` |
| `%$` | åŒ¹é… `$` |

**ç¤ºä¾‹**
```lua
print(string.match("3+2=5", "%d+%+%d+"))  --> 3+2
```

---

## **3. é‡è¯åŒ¹é…**
| é‡è¯ | ä½œç”¨ |
|------|------|
| `+` | **åŒ¹é… 1 æ¬¡æˆ–å¤šæ¬¡** |
| `*` | **åŒ¹é… 0 æ¬¡æˆ–å¤šæ¬¡** |
| `?` | **åŒ¹é… 0 æ¬¡æˆ– 1 æ¬¡** |
| `{n,m}` | **åŒ¹é… n åˆ° m æ¬¡ï¼ˆLua ä¸æ”¯æŒï¼‰** |

**ç¤ºä¾‹**
```lua
print(string.match("abc123xyz", "%a+"))  --> abc
print(string.match("abc123xyz", "%d*"))  --> ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰
print(string.match("abc123xyz", "%d+"))  --> 123
```

---

## **4. å®šä¹‰å­—ç¬¦é›†**
| ç¬¦å· | ä½œç”¨ |
|------|------|
| `[xyz]` | åŒ¹é… `x`ã€`y` æˆ– `z` |
| `[^xyz]` | **åŒ¹é…é** `x`ã€`y`ã€`z` çš„å­—ç¬¦ |
| `[a-z]` | **åŒ¹é… a-z ä¹‹é—´çš„å­—ç¬¦** |
| `[A-Z0-9]` | **åŒ¹é…å¤§å†™å­—æ¯æˆ–æ•°å­—** |

**ç¤ºä¾‹**
```lua
print(string.match("Lua 5.4", "[0-9]+"))  --> 5
print(string.match("Hello!", "[^aeiou]+"))  --> H
```

---

## **5. æ•è·ï¼ˆæå–åŒ¹é…éƒ¨åˆ†ï¼‰**
| è§„åˆ™ | ä½œç”¨ |
|------|------|
| `(pattern)` | **æ•è·**åŒ¹é…çš„å†…å®¹ |

**ç¤ºä¾‹**
```lua
local word, number = string.match("abc123", "(%a+)(%d+)")
print(word, number)  --> abc 123
```

---

## **6. æœç´¢ä¸æ›¿æ¢**
Lua æä¾› `string.gsub` è¿›è¡Œæ›¿æ¢ï¼š
```lua
local s = "Hello 123 Lua 456"
print(string.gsub(s, "%d+", "#"))  --> Hello # Lua #
```

---

## **7. é”šç‚¹åŒ¹é…**
| ç¬¦å· | ä½œç”¨ |
|------|------|
| `^` | **åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´** |
| `$` | **åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾** |

**ç¤ºä¾‹**
```lua
print(string.match("Hello World", "^Hello"))  --> Hello
print(string.match("Hello World", "World$"))  --> World
```

---

## **8. `string.find`ã€`string.match`ã€`string.gsub` åŒºåˆ«**
| æ–¹æ³• | ä½œç”¨ |
|------|------|
| `string.find(s, pattern)` | **æŸ¥æ‰¾åŒ¹é…çš„ä½ç½®** |
| `string.match(s, pattern)` | **æå–ç¬¬ä¸€ä¸ªåŒ¹é…** |
| `string.gsub(s, pattern, replace)` | **æ›¿æ¢** |

**ç¤ºä¾‹**
```lua
local s = "Hello Lua 123"

print(string.find(s, "%a+"))  --> 1 5 ï¼ˆè¿”å›åŒ¹é…ä½ç½®ï¼‰
print(string.match(s, "%a+"))  --> Hello ï¼ˆè¿”å›åŒ¹é…æ–‡æœ¬ï¼‰
print(string.gsub(s, "%a+", "#"))  --> # # 123
```

---

## **æ€»ç»“**
- **Lua çš„æ¨¡å¼åŒ¹é…ç±»ä¼¼æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½†ä¸æ˜¯æ ‡å‡†æ­£åˆ™**ï¼Œå¸¸ç”¨äºå­—ç¬¦ä¸²æŸ¥æ‰¾ã€æ›¿æ¢ç­‰æ“ä½œã€‚
- **ä¸æ”¯æŒ `{n,m}` è¿™æ ·çš„ç²¾ç¡®åŒ¹é…**ï¼Œä½†å¯ä»¥ç”¨ `string.rep` å˜é€šå®ç°ã€‚
- **ä½¿ç”¨ `()` è¿›è¡Œæ•è·ï¼Œç”¨ `string.gsub` è¿›è¡Œæ›¿æ¢**ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚
- **ä¸æ”¯æŒ `\d` è¿™æ ·çš„æ­£åˆ™æ ¼å¼ï¼Œè€Œæ˜¯ `%d` ä»£æ›¿**ã€‚

å¦‚æœéœ€è¦æ›´å¼ºçš„æ­£åˆ™åŠŸèƒ½ï¼Œå¯ä»¥ç»“åˆ **PCREï¼ˆLua æ­£åˆ™åº“ï¼‰** è¿›è¡Œæ‰©å±•ã€‚

# ç¬”è®°

- é»˜è®¤å˜é‡æ˜¯å…¨å±€å˜é‡
  - local æœ¬åœ°å˜é‡
- æœªèµ‹å€¼çš„ä¸º **nil**
- å¯ä»¥åŒæ—¶èµ‹å€¼a,v=1,2
- åªæœ‰ä¸€ç§ç±»å‹numberï¼šæ”¯æŒ16è¿›åˆ¶ã€ç§‘å­¦è®¡æ•°æ³•2e10ã€æ¬¡æ–¹
- å•å¼•å· (') å’ŒåŒå¼•å· (") æœ¬è´¨ä¸Šæ˜¯ç­‰ä»·çš„ï¼Œéƒ½ç”¨äºè¡¨ç¤ºå­—ç¬¦ä¸²ã€‚
- å¯ä»¥åŒæ—¶æ‰“å°å¤šä¸ªå˜é‡
- å¤šè¡Œæ–‡æœ¬[[   ]]
- å•è¡Œæ³¨é‡Š--
  - å¤šè¡Œæ³¨é‡Šæ¨èä½¿ç”¨ --[=[æ³¨é‡Šå†…å®¹]=]ï¼Œè¿™æ ·å¯ä»¥é¿å…é‡åˆ°table[table[idx]]æ—¶å°±å°†å¤šè¡Œæ³¨é‡Šç»“æŸäº†ã€‚
  - å¤šè¡Œæ³¨é‡ŠåŠ  - å–æ¶ˆæ³¨é‡Šä¸­é—´ä»£ç å¯ä»¥ç»§ç»­è¿è¡Œï¼Œå•è¡Œæ³¨é‡Šæ²¡æœ‰æ­¤åŠŸèƒ½ã€‚

    ---[[
    print('å–æ¶ˆå¤šè¡Œæ³¨é‡Š')
    --]]
  - å¤šè¡Œ  
  --[[
 å¤šè¡Œæ³¨é‡Š
 å¤šè¡Œæ³¨é‡Š
 --]]

- å­—ç¬¦ä¸²è¿æ¥ç¬¦..
  - å¦‚æœæœ‰å¤§é‡å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå»ºè®®ä½¿ç”¨ table.concatï¼Œæ€§èƒ½æ›´ä¼˜ï¼š
    
    local words = { "Hello", " ", "World", "!" }

    local result = table.concat(words)
- Lua å‡½æ•°ä¸éœ€è¦å£°æ˜è¿”å›å€¼ç±»å‹å’Œå‚æ•°ç±»å‹
- æ²¡æœ‰ç±»å’Œå¯¹è±¡çš„åŸç”Ÿæ¦‚å¿µï¼Œä½†å¯ä»¥ç”¨ table + metatable å®ç°
- æœ€å¥½ä¸è¦ä½¿ç”¨ä¸‹åˆ’çº¿åŠ å¤§å†™å­—æ¯çš„æ ‡è¯†ç¬¦ï¼Œå› ä¸ºLuaçš„ä¿ç•™å­—ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚
- è¡¨ï¼šæ ‡è¯†ç¬¦å¯ä»¥ä½¿ç”¨` . `æˆ–` [""] `è®¿é—®ï¼Œå¦‚æœæ ‡è¯†ç¬¦åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ç©ºæ ¼ï¼‰ï¼Œå¿…é¡»ç”¨ `[""]` è®¿é—®ã€‚æ•´æ•°ä½œä¸ºä¸‹æ ‡ã€å­—ç¬¦ä¸²ä½œä¸ºä¸‹æ ‡
  
    local person = {
        name = "Alice",
        age as = 25
    }

    print(person.name)  -- Alice

    print(person["age as"])  -- 25
- åœ¨é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰ç¼–ç¨‹æ—¶ï¼Œself ä»£è¡¨å½“å‰å¯¹è±¡ã€‚
- æ ‡è¯†ç¬¦ï¼š
  - and or not	é€»è¾‘è¿ç®—
  - if elseif else then end	æ¡ä»¶åˆ¤æ–­
  - for while repeat until	å¾ªç¯ç»“æ„
  - function return	å®šä¹‰å‡½æ•°ã€è¿”å›å€¼
  - local	å˜é‡ä½œç”¨åŸŸ  ç”¨äºä»£ç å—ä¸­
  - nil true false	å˜é‡å€¼
  - do end	ä»£ç å—
  - goto	ä»£ç è·³è½¬
- æ•°ç»„
  1. nilä¼šä¸­æ–­æ•°ç»„ä¸‹æ ‡å’Œé•¿åº¦å—ï¼Ÿ
  2. forå¾ªç¯ä¸èƒ½éå†å°äºç­‰äºé›¶çš„ç´¢å¼•
  3. ä¸èƒ½éå†åˆ°ä¸è¿ç»­ç´¢å¼•
  4. æ•°ç»„ä¸‹æ ‡å¼€å§‹å€¼ä¸º1
  5. #è·å–æ•°ç»„é•¿åº¦
- forå¾ªç¯ä¸­ indexå€¼ä¸èƒ½ä¿®æ”¹
  
    for i=10,1,-1 do 

    print(i)

    end
- _Gå…¨å±€è¡¨ï¼šå­˜æ”¾å…¨å±€å˜é‡
- 0ä¸ºture
- åªæœ‰nil å’Œfalse ä¸ºå‡
- ä¸æ”¯æŒè‡ªå¢è‡ªå‡æ“ä½œ

- ä¸ç­‰äºï¼š~=     ç­‰äºï¼š==
- äº¤æ¢  a,b=b,a
- å‡½æ•°ï¼š
  1. ä¸æ”¯æŒé‡è½½,æ”¯æŒé‡å†™
  2. å‡½æ•°å˜é•¿å‚æ•°â€¦éœ€è¦å†…éƒ¨ç”¨è¡¨æ¥æ”¶ï½›â€¦ï½æ‰èƒ½ä½¿ç”¨
  3. é—­åŒ… å‡½æ•°åµŒå¥— å¤–å±‚å‡½æ•°çš„å‚æ•°è¢«åµŒå¥—çš„å‡½æ•°ä½¿ç”¨æ—¶,å»¶é•¿ç”Ÿå‘½å‘¨æœŸ
    ``` lua
    a=function ()
    print("hello")
    end
    --ç­‰ä»·
    function Showa()
    print("hello")
    end
    ```
- return  å¯ä»¥è¿”å›å¤šä¸ªå€¼ç”¨é€—å·éš”å¼€
- Lua ä¸­æœ‰ 8 ä¸ªåŸºæœ¬ç±»å‹åˆ†åˆ«ä¸ºï¼šnilã€booleanã€numberã€stringã€userdataã€functionã€thread å’Œ tableã€‚
  - userdata	è¡¨ç¤ºä»»æ„å­˜å‚¨åœ¨å˜é‡ä¸­çš„Cæ•°æ®ç»“æ„
  - number	è¡¨ç¤ºåŒç²¾åº¦ç±»å‹çš„å®æµ®ç‚¹æ•°
- æ–‡ä»¶è°ƒç”¨ï¼šrequire("è·¯å¾„.æ–‡ä»¶å")
  - ä¸å¸¦æ‹“å±•å  
  - åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œ**å³ä½¿å¤šæ¬¡è°ƒç”¨éƒ½æ˜¯è¿”å›çš„ç¬¬ä¸€æ¬¡è°ƒç”¨çš„å€¼**
  - ä»package.pathä¸­æŸ¥æ‰¾ï¼Œæˆ‘ä»¬å¯ä»¥æå‰ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå°†æ–°è·¯å¾„åŠ è½½åˆ°è¯¥å­—æ®µä¸­ï¼Œè°ƒç”¨æ—¶å°±ä¸ç”¨æŒ‡å®šè·¯å¾„äº†
  - Package.loaded(xx)åˆ¤æ–­requireåŠ è½½çš„æ–‡ä»¶æ˜¯å¦è¢«å¤¹åœ¨.  Package.loaded(xx)=nilå¸è½½èµ„æº
- loadstring / load åªæ˜¯ç¼–è¯‘ä»£ç ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œã€‚**éœ€è¦æ˜¾å¼è°ƒç”¨è¿”å›çš„å‡½æ•°æ‰èƒ½æ‰§è¡Œä»£ç **ã€‚
  - æ¯æ¬¡è°ƒç”¨ loadï¼Œéƒ½ä¼šåˆ›å»ºæ–°çš„å‡½æ•°å¯¹è±¡ï¼Œ**å³ä¾¿ä»£ç ç›¸åŒï¼Œè¿”å›çš„å‡½æ•°ä¹Ÿæ˜¯ä¸åŒçš„**ã€‚
- dofile ç›´æ¥åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ª Lua æ–‡ä»¶ï¼Œ**ç›¸å½“äº loadfile + è°ƒç”¨**ã€‚
  - ä»£ç è¿è¡Œåœ¨å…¨å±€ä½œç”¨åŸŸï¼Œæ‰€ä»¥ dofile æ‰§è¡Œçš„è„šæœ¬å¯ä»¥å®šä¹‰å…¨å±€å˜é‡å’Œå‡½æ•°ã€‚
  - dofile æ¯æ¬¡éƒ½ä¼šæ‰§è¡Œæ–‡ä»¶ï¼Œä¸ä¼šç¼“å­˜ç»“æœã€‚
  - **å¦‚æœ æ‰§è¡Œçš„ Lua æ–‡ä»¶å®šä¹‰äº†å…¨å±€å˜é‡å‚ä¸è®¡ç®—è¿”å›å€¼ï¼Œä¼šå½±å“åç»­ dofile è°ƒç”¨è¿”å›å€¼**ã€‚

- å­—ç¬¦ä¸²
  - ç¬¬ä¸€ä¸ªä»1å¼€å§‹ï¼Œå€’æ•° ç¬¬ä¸€ä¸ªæ˜¯-1
  - è¯­æ³•ç³–è°ƒç”¨æ–¹æ³•ï¼š å¯ä»¥æ˜¯ç”¨å­—ç¬¦ä¸²å˜é‡ï¼šå­—ç¬¦ä¸²å‡½æ•°ï¼ˆï¼‰
- æ­£åˆ™è¡¨è¾¾å¼
  - Lua ä½¿ç”¨ % ä½œä¸ºè½¬ä¹‰ç¬¦ï¼Œè€Œä¸æ˜¯ \
  -  **+**	åŒ¹é… 1 æ¬¡æˆ–å¤šæ¬¡
  -  `*`	åŒ¹é… 0 æ¬¡æˆ–å¤šæ¬¡
  -  ?	åŒ¹é… 0 æ¬¡æˆ– 1 æ¬¡
  -  {n,m}	åŒ¹é… n åˆ° m æ¬¡ï¼ˆLua ä¸æ”¯æŒï¼‰
    - .	åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆæ¢è¡Œç¬¦ \n é™¤å¤–ï¼‰
    - %a	åŒ¹é…ä»»æ„å­—æ¯ï¼ˆA-Z, a-zï¼‰
    - %d	åŒ¹é…ä»»æ„æ•°å­—ï¼ˆ0-9ï¼‰
    - %l	åŒ¹é…å°å†™å­—æ¯ï¼ˆa-zï¼‰
    - %u	åŒ¹é…å¤§å†™å­—æ¯ï¼ˆA-Zï¼‰
    - %s	åŒ¹é…ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œï¼‰
    - %w	åŒ¹é…å­—æ¯+æ•°å­—ï¼ˆA-Z, a-z, 0-9ï¼‰
    - %x	åŒ¹é…åå…­è¿›åˆ¶å­—ç¬¦ï¼ˆ0-9, A-F, a-fï¼‰
    - %c	åŒ¹é…æ§åˆ¶å­—ç¬¦ï¼ˆå¦‚ \nã€\tï¼‰
    - %p	åŒ¹é…æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚ .,!?ï¼‰
    - %z	åŒ¹é… \0ï¼ˆnull å­—ç¬¦ï¼‰
    - %f[set]	åŒ¹é… set å®šä¹‰çš„è¾¹ç•Œ
    - (pattern)	æ•è·åŒ¹é…çš„å†…å®¹
    - ^	åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´
    - $	åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾

- å…ƒè¡¨ï¼ˆè¡¨çš„çˆ¸çˆ¸ï¼‰   å½“æˆ‘ä»¬å­è¡¨ä¸­è¿›è¡Œä¸€äº›`ç‰¹å®šæ“ä½œ`æ—¶ä¼šæ‰§è¡Œå…ƒè¡¨ä¸­çš„å†…å®¹
  ``` lua
    meta={}
    myTable={}
    setmetatable(myTable,meta)  ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå­è¡¨   ç¬¬äºŒä¸ªå‚æ•°ï¼šåŸè¡¨ï¼ˆçˆ¸çˆ¸ï¼‰
  ```
  - è¡¨é»˜è®¤æ²¡æœ‰ç»§æ‰¿ã€æ²¡æœ‰å…ƒè¡Œä¸ºï¼Œä½†å¯ä»¥ä½¿ç”¨**å…ƒè¡¨ï¼ˆmetatableï¼‰**æ‰©å±•å®ƒçš„åŠŸèƒ½ã€‚
  - å…ƒè¡¨æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šçš„è¡¨ï¼Œä½†å®ƒçš„ä½œç”¨æ˜¯â€œæ§åˆ¶â€å¦ä¸€ä¸ªè¡¨çš„è¡Œä¸ºã€‚
  - é€šè¿‡ setmetatable(t, mt) å°†å…ƒè¡¨ mt ç»‘å®šåˆ°è¡¨ t ä¸Šã€‚
  - å…ƒè¡¨å¯ä»¥å®šä¹‰ç‰¹æ®Šçš„å…ƒæ–¹æ³•ï¼ˆmetamethodï¼‰ï¼Œæ¯”å¦‚ __indexã€__newindexã€__addã€__tostring ç­‰ã€‚
  - `ç‰¹å®šæ“ä½œ`
    - __call è®©è¡¨å¯ä»¥è¢«å½“ä½œå‡½æ•°è°ƒç”¨ã€‚å½“å­è¡¨è¢«å½“åšä¸€ä¸ªå‡½æ•°æ¥ä½¿ç”¨æ—¶ ä¼šé»˜è®¤è°ƒç”¨è¿™ä¸ª ca11ä¸­çš„å†…å®¹ï¼Œå½“å¸Œæœ›ä¼ å‚æ•°æ—¶ ä¸€å®šè¦è®°ä½ é»˜è®¤ç¬¬ä¸€ä¸ªå‚æ•° æ˜¯è°ƒç”¨è€…è‡ªå·±
    - __index å…è®¸ä¸€ä¸ªè¡¨åœ¨è®¿é—®ä¸å­˜åœ¨çš„å­—æ®µæ—¶ï¼Œä»å…ƒè¡¨ä¸­æŸ¥æ‰¾ã€‚
      - _Indexå­˜åœ¨äºï¼Ÿ
		1. ä½œä¸ºå‡½æ•°ï¼Œä¼ é€’çš„ç´¢å¼•ç»è¿‡å‡½æ•°ç­›é€‰åˆ¤æ–­è¿”å›ä¸€ä¸ªå€¼
		2. ä½œä¸ºè¡¨ï¼Œè¿”å›è¡¨ç§å…ƒç´ 
    - __newindex æ§åˆ¶ç»™è¡¨ä¸­ä¸å­˜åœ¨çš„å­—æ®µèµ‹å€¼æ—¶çš„è¡Œä¸ºã€‚
    - __tostring å­è¡¨è¦è¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨æ—¶ ä¼šé»˜è®¤è°ƒç”¨è¿™ä¸ªå…ƒè¡¨ä¸­çš„tostringæ–¹æ³•
  - 
  - é¢å‘å¯¹è±¡
    -  ä½¿ç”¨ table ä½œä¸ºå¯¹è±¡ï¼Œå‡½æ•° ä½œä¸ºæ–¹æ³•ï¼Œå¹¶é€šè¿‡ self è®¿é—®æˆå‘˜å˜é‡ã€‚
    -  æœ‰æ„é€ å‡½æ•°
    -  ç»§æ‰¿æœºåˆ¶
    -  æ²¡æœ‰ override å…³é”®å­—ï¼Œä½†å¯ä»¥æ‰‹åŠ¨é‡å†™æ–¹æ³•å®ç°å¤šæ€
    -  ç±»
		1. ç”¨è¡¨æ¥å®ç°ï¼Œè·å–æ–¹å¼æ›´åƒæ˜¯c#ä¸­çš„é™æ€ç±»
		2. å¯ä»¥åœ¨è¡¨å†…å£°æ˜å’Œè¡¨å¤–å£°æ˜æˆå‘˜
		3. å‡½æ•°åœ¨è¡¨ å¤–éƒ¨å£°æ˜
			1. class.fucname = function ()
			2. function class.fucname ()
		4. åœ¨è¡¨å†…éƒ¨å‡½æ•°ä¸­è°ƒç”¨è¡¨æœ¬èº«å±æ€§æˆ–æ–¹æ³•
			1. å‰ç¼€ä¸€å®šè¦æŒ‡æ˜æ˜¯è°çš„å±æ€§æˆ–æ–¹æ³•ï¼ŒæŒ‡å®šæ‹¥æœ‰è€…ï¼Œä¸èƒ½ç›´æ¥å†™å˜é‡åï¼Œç›´æ¥å†™çš„å˜é‡åä»£è¡¨çš„æ˜¯å…¨å±€å˜é‡ä¸è¡¨ä¸­çš„å˜é‡æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„
			2. åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨è‡ªå·±å±æ€§æˆ–è€…æ–¹æ³•ï¼Œéœ€è¦æŠŠè‡ªå·±ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ è¿›æ¥åœ¨å†…éƒ¨è®¿é—®ï¼Œlua æ²¡æœ‰å‚æ•°ç±»å‹,æ‰€ä»¥å¯ä»¥çœ‹æˆæ˜¯èŒƒå‹
				1. class.fucname(class)
				2. class:fucname() ï¼šè°ƒç”¨æ–¹æ³•ä¼šé»˜è®¤æŠŠè°ƒç”¨è€…ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥æ–¹æ³•ä¸­
		5. :ä½¿ç”¨
			1. å‡½æ•°å¤–éƒ¨è°ƒç”¨ï¼Œè¡¨ç¤ºé»˜è®¤ä¼ å…¥ä¸€ä¸ªå‚æ•°æ˜¯è‡ªå·±
			2. å‡½æ•°å¤–éƒ¨å£°æ˜ï¼Œè¡¨ç¤ºé»˜è®¤æœ‰ä¸€ä¸ªå‚æ•°æ˜¯è‡ªå·±ï¼Œå‡½æ•°å†…éƒ¨è·å–è¿™ä¸ªå‚æ•°éœ€è¦ç”¨selfè¡¨ç¤ºé»˜è®¤ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°


1. åƒåœ¾å›æ”¶(ç½®ç©ºnil)-ä¸»åŠ¨å›æ”¶é‡Šæ”¾å†…å­˜-åˆ‡æ¢åœºæ™¯/å†…å­˜è¾¾åˆ°ç“¶é¢ˆ
	1. collectgarbage(â€œcountâ€)lua å ç”¨å†…å­˜
	2. collectgarbage(â€œcollectâ€)å›æ”¶åƒåœ¾
2. os.time()æ—¶é—´s ç³»ç»Ÿæ—¶é—´
	1. os.date()è·å–æ—¶é—´çš„è¡¨ï¼Œå¹´æœˆæ—¥æ—¶åˆ†ç§’
3. math.abs()
	1.math.randomseed(os.time)
	math.random

	
4. è¿­ä»£å™¨
	1.  å°äºç­‰äºé›¶çš„æ‰€æœ‰æ‰¾ä¸åˆ°
	2. pairsæ¯”impairså¼ºå¤§ï¼Œå¯ä»¥éå†æ‰€æœ‰æˆå‘˜åŒ…æ‹¬å°äºç­‰äºé›¶çš„ç´¢å¼•(ä¸è§„åˆ™çš„è¡¨)
	3. å¯ä»¥åªéå†key
	4. ipairs æ•°å­—ä¸‹æ ‡ä¸è¿ç»­ä¼šä¸­æ–­ï¼Œpairs æ‰€æœ‰é€šç”¨ï¼ˆä½¿ç”¨nextå‡½æ•°å®ç°ï¼‰
	5. nextå‡½æ•°å¯ä»¥ç”¨äºåˆ¤æ–­è¡¨æ˜¯å¦ä¸ºç©º
5. å­—å…¸
	1. è®¿é—®æ–¹å¼a[â€œkeyâ€]or a.key 
	2. éå†å¥½åƒå­—å…¸ä¸€å®šè¦ç”¨pairs

6. è¡¨
	- Insert 
	- Remove 
	- Sort 
	- Concat
7. çŸ­è·¯è¿ç®— 
	1. andæœ‰çœŸåˆ™çœŸ 
	2. oræœ‰å‡åˆ™å‡
	3. å¯ä»¥ä½¿ç”¨ and or  æ„æˆä¸‰å…ƒè¿ç®—ç¬¦ï¼Œè¿”å›ç»“æœå¯¹åº”çš„å€¼æˆ–è€…boolå€¼ï¼ŒçŸ­è·¯æ±‚å€¼ï¼š
        - and åœ¨ ç¬¬ä¸€ä¸ªå€¼ä¸º false æˆ– nil æ—¶ï¼Œç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼›å¦åˆ™ï¼Œè¿”å›ç¬¬äºŒä¸ªå€¼ã€‚
        - or åœ¨ ç¬¬ä¸€ä¸ªå€¼ä¸º false æˆ– nil æ—¶ï¼Œè¿”å›ç¬¬äºŒä¸ªå€¼ï¼›å¦åˆ™ï¼Œç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªå€¼ã€‚
  
                print(10>11 and "yes" or "no")

8. åç¨‹ coroutine
   1. åˆ›å»º
      1. co=coroutine.create(fuc) è¿”å›çš„æ˜¯åç¨‹ï¼ˆçº¿ç¨‹ï¼‰
         1. è°ƒç”¨ï¼šcoroutine.resume(co)   è¯¥å‡½æ•°è¿”å›å€¼ç¬¬ä¸€ä¸ªä¸ºåç¨‹æ‰§è¡ŒæˆåŠŸçš„ä¸å¦
      2. cor=coroutine.wrap(fuc)  è¿”å›çš„æ˜¯å‡½æ•°
         1. è°ƒç”¨ï¼šcor()
   2. æŒ‚èµ· coroutine.yield()  æ¯æ¬¡è°ƒç”¨æ‰§è¡Œéƒ½ä¼šç»§ç»­åç¨‹  ï¼Œyield(yieldReturn)ï¼Œcoroutine.resumeçš„ç¬¬äºŒä¸ªè¿”å›å€¼å°±æ˜¯å®ƒ  `isSucc ï¼ŒyieldReturn = coroutine.wrap(fuc)`
   3. çŠ¶æ€ coroutine.status
      1. dead  æ²¡æœ‰æŒ‚èµ·çš„åç¨‹
      2. suspended æš‚åœ  æŒ‚èµ·çš„åç¨‹
      3. running   åªèƒ½åœ¨åç¨‹å†…è·å–è¯¥çŠ¶æ€    coroutine.running()å¯ä»¥å¾—åˆ°å½“å‰æ­£åœ¨è¿è¡Œçš„åç¨‹çš„ç¼–å·
9.  Person.sayHello() â‰ˆ é™æ€å‡½æ•°   p1:sayHello() â‰ˆ æˆå‘˜å‡½æ•°