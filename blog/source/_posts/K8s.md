---
title: K8s
date: 2026-01-22 12:06:02
updated: 2026-01-22 12:06:02
tags: [分布式,微服务,集群,K8s]
categories: 网络编程
keywords: [分布式,微服务,集群管理,K8s]
description: 棋牌捕鱼类游戏工作项目中用到
---

服务器工作流程：开发->镜像打包docker->部署到k8s

## K8s（Kubernetes）通俗解释

**K8s是一个管理大量集装箱（容器）的“智能码头操作系统”**。

想象一下：你有一个现代化码头，里面要运行成千上万个集装箱（每个集装箱是一个应用服务）。K8s就是这个码头的**自动化管理系统**，它负责：
- 自动把集装箱放到合适的货轮上（调度到服务器）
- 哪个集装箱坏了就立刻换新的（自愈）
- 货多了自动加集装箱，货少了自动减少（自动伸缩）
- 确保不同集装箱之间能互相通信（服务发现）

---

## K8s到底是干什么的？（实际用途）

### 1. **容器化应用的管理员**
- 你开发的应用用Docker打包成“集装箱”（容器）
- K8s帮你管理成百上千个这样的容器，让它们井井有条地运行

### 2. **解决“在我的机器上能跑”的问题**
- 开发说：“在我电脑上好好的！”
- 运维说：“服务器上怎么就不行了！”
- K8s提供**一致的运行环境**，从开发到生产完全一样

### 3. **自动化的运维机器人**
传统运维：
```
凌晨3点电话响了 → 服务器挂了 → 手动登录 → 重启服务 → 检查日志 → 祈祷...
```
K8s运维：
```
服务器挂了 → K8s自动发现 → 自动重启 → 自动迁移到其他机器 → 你继续睡觉
```

### 4. **资源的高效利用者**
传统部署：一台服务器只跑一个应用，CPU用10%，浪费90%
K8s部署：一台服务器跑几十个应用，资源利用率提升到80%+

---

## K8s核心理论（学什么）

### 1. **核心架构**
```
控制平面（Control Plane）：大脑
    ├── API Server：总指挥中心（唯一入口）
    ├── Scheduler：调度员（决定Pod放哪）
    ├── Controller Manager：监控管理员
    └── etcd：数据库（记住所有状态）
    
工作节点（Node）：干活的工人
    ├── Kubelet：节点管家
    ├── 容器运行时（如Docker）：真正跑容器的
    └── Kube-proxy：网络代理
```

### 2. **核心概念（必须掌握的）**

#### **Pod**
- **最小部署单元** = 一个或多个紧密相关的容器
- 就像“豆荚”里的豌豆，共享网络和存储
- 通常一个Pod一个容器，但有时需要辅助容器（Sidecar）

#### **Service**
- **服务的固定电话号**
- Pod可能随时死、随时生、IP会变
- Service提供一个稳定IP和DNS名，让其他服务能找到它

#### **Deployment**
- **应用的生命周期管理器**
- 声明式定义：我想要3个副本的Web应用
- K8s自动创建、更新、回滚，保持永远是3个健康副本

#### **其他重要概念**
- **ConfigMap**：把配置从代码中分离（类似“配置文件中心”）
- **Secret**：安全地存储密码、密钥
- **Volume**：持久化存储（容器重启数据不丢）
- **Namespace**：虚拟集群，用于环境隔离（开发/测试/生产）

### 3. **核心工作模式：声明式 vs 命令式**
- **命令式**（传统）：`docker run...`, `docker stop...` （一步步指挥）
- **声明式**（K8s）：写一个YAML文件说“我想要什么状态”
  ```yaml
  apiVersion: apps/v1
  kind: Deployment
  spec:
    replicas: 3  # 我想要3个副本
    template:
      containers:
      - name: web
        image: nginx:latest
  ```
  K8s：好的，我保证永远有3个nginx在跑

---

## 学了K8s有什么用？（价值）

### 对个人：
1. **职业竞争力**：云原生时代的必备技能，薪资溢价30%-50%
2. **就业方向**：
   - DevOps工程师（月薪25K-50K+）
   - 云原生工程师（月薪30K-60K+）
   - SRE（站点可靠性工程师）（月薪40K-80K+）
3. **技能提升**：从只会写代码 → 懂架构、懂运维、懂分布式系统

### 对公司/项目：
1. **成本降低**：
   - 服务器资源利用率从10-20% → 60-80%
   - 运维人力减少，自动化处理日常故障
   
2. **稳定性提升**：
   - 99.9% → 99.99%可用性（全年停机从8.7小时→52分钟）
   - 蓝绿部署、金丝雀发布，更新不影响用户

3. **敏捷性飞跃**：
   - 新应用部署：从几天 → 几分钟
   - 弹性伸缩：应对双十一流量，自动扩容100倍

---

## 学习路径建议（从易到难）

### 第一阶段：入门（1-2周）
1. 理解容器基础（先学Docker）
2. 在本地用Minikube或Kind搭建K8s玩一玩
3. 部署第一个Pod：`kubectl run nginx --image=nginx`
4. 学习写简单的YAML文件

### 第二阶段：核心掌握（1-2个月）
1. 掌握Pod、Deployment、Service、ConfigMap
2. 学习Ingress（外部访问）、Volume（存储）
3. 理解探针（健康检查）、资源限制
4. 动手做项目：部署一个完整的Web应用（前端+后端+数据库）

### 第三阶段：进阶（3-6个月）
1. Helm：应用打包和部署
2. 监控告警：Prometheus + Grafana
3. 日志收集：EFK/ELK Stack
4. 服务网格：Istio（高级功能）
5. CI/CD集成：GitLab + K8s自动部署

---

## 现实应用场景举例

### 场景1：电商大促
```
双十一前：预估流量增加10倍
传统做法：提前一个月买服务器、装系统、部署、压测...
K8s做法：修改YAML，replicas: 10 → 100，点一下部署，自动扩容
```

### 场景2：滚动更新无感知
```
老板：凌晨2点更新版本，不能影响用户
传统：挂维护公告，停服30分钟
K8s：滚动更新，先起新Pod，再删旧Pod，用户无感知
```

### 场景3：多环境管理
```
开发、测试、预生产、生产
传统：4套独立物理机，成本高，环境不一致
K8s：4个Namespace，共用集群，资源动态分配
```

---

## 一句话总结

**K8s是云原生时代的操作系统**，它把成百上千台服务器变成一台“超级计算机”，让你用简单的YAML文件就能管理大规模的分布式应用，实现自动化运维、弹性伸缩和高可用。

如果你现在开始学，3年后回头看，会发现这是职业生涯中最值得的投资之一——就像10年前学习云计算，5年前学习Docker一样。
